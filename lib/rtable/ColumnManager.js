"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,r=Array(e.length);n<e.length;n++)r[n]=e[n];return r}return Array.from(e)}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},_createClass=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_Column=require("./Column"),_Column2=_interopRequireDefault(_Column),_ColumnGroup=require("./ColumnGroup"),_ColumnGroup2=_interopRequireDefault(_ColumnGroup),ColumnManager=function(){function e(n,r){_classCallCheck(this,e),this._cached={},this.columns=n||this.normalize(r)}return _createClass(e,[{key:"isAnyColumnsFixed",value:function(){var e=this;return this._cache("isAnyColumnsFixed",function(){return e.columns.some(function(e){return!!e.fixed})})}},{key:"isAnyColumnsLeftFixed",value:function(){var e=this;return this._cache("isAnyColumnsLeftFixed",function(){return e.columns.some(function(e){return"left"===e.fixed||e.fixed===!0})})}},{key:"isAnyColumnsRightFixed",value:function(){var e=this;return this._cache("isAnyColumnsRightFixed",function(){return e.columns.some(function(e){return"right"===e.fixed})})}},{key:"leftColumns",value:function(){var e=this;return this._cache("leftColumns",function(){return e.groupedColumns().filter(function(e){return"left"===e.fixed||e.fixed===!0})})}},{key:"rightColumns",value:function(){var e=this;return this._cache("rightColumns",function(){return e.groupedColumns().filter(function(e){return"right"===e.fixed})})}},{key:"leafColumns",value:function(){var e=this;return this._cache("leafColumns",function(){return e._leafColumns(e.columns)})}},{key:"leftLeafColumns",value:function(){var e=this;return this._cache("leftLeafColumns",function(){return e._leafColumns(e.leftColumns())})}},{key:"rightLeafColumns",value:function(){var e=this;return this._cache("rightLeafColumns",function(){return e._leafColumns(e.rightColumns())})}},{key:"groupedColumns",value:function(){var e=this;return this._cache("groupedColumns",function(){var n=function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];u[r]=u[r]||[];var o=[],i=function(e){var n=u.length-r;e&&!e.children&&n>1&&(!e.rowSpan||e.rowSpan<n)&&(e.rowSpan=n)};return n.forEach(function(l,a){var c=_extends({},l);u[r].push(c),t.colSpan=t.colSpan||0,c.children&&c.children.length>0?(c.children=e(c.children,r+1,c,u),t.colSpan=t.colSpan+c.colSpan):t.colSpan++;for(var s=0;s<u[r].length-1;++s)i(u[r][s]);a+1===n.length&&i(c),o.push(c)}),o};return n(e.columns)})}},{key:"normalize",value:function(e){var n=this,r=[];return _react2.default.Children.forEach(e,function(e){if(n.isColumnElement(e)){var t=_extends({},e.props);e.key&&(t.key=e.key),e.type===_ColumnGroup2.default&&(t.children=n.normalize(t.children)),r.push(t)}}),r}},{key:"isColumnElement",value:function(e){return e&&(e.type===_Column2.default||e.type===_ColumnGroup2.default)}},{key:"reset",value:function(e,n){this.columns=e||this.normalize(n),this._cached={}}},{key:"_cache",value:function(e,n){return e in this._cached?this._cached[e]:(this._cached[e]=n(),this._cached[e])}},{key:"_leafColumns",value:function(e){var n=this,r=[];return e.forEach(function(e){e.children?r.push.apply(r,_toConsumableArray(n._leafColumns(e.children))):r.push(e)}),r}}]),e}();exports.default=ColumnManager;